# Описание задачи
В данном проекте мы по заказу металлургического комбината ООО «Так закаляем сталь» построили модель машинного обучения для оптимизирования технологического процесса. 

Компания предоставила накопленные сырые данные, которые были очищены от аномальных значений и выбросов и проанализированы. На основе анализа была подготовлена итоговая таблица признаков, которая использовалась для обучения моделей. 

В качестве кандидатов рассматривались линейные модели `ElasticNet`, ансамблевые `RandomFForest` и модели градиентного бустинга `LightGBM` и `CatBoost`. В результате обучения лучшей по метрике МАЕ на кросс-валидации (5 дроблений) оказалась модель градиентного бустинга `CatBoost`, которая способна предсказывать температуру сплава с точностью до 5.9 градуса. 

Таким образом нами была построена модель, способная довольно точно восроизводить процесс создания различных сплавов, что поможет комбинату не только сэкономить на электроэнергии и материалах, но и позволит проводить эксперименты для новых видов сплавов.


# Отчет по проекту - Промышленность 
___
## Введение в проблему
Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Вам предстоит построить модель, которая предскажет температуру стали.

___
## Цель проекта 
Построить модель машинного обучения, которая сможет искусственно воспроизводить процесс создания сплава, определяя его конечную температуру. Таким образом можно будет проводить численные эксперименты по оптимизации технологического процесса, - (сокращение или увеличения цикла циклов до достижения сплавом определенной консистенции, оптимизация времени нагрева) - что позволит сократить расходы материалов и электроэнергии.
___
## Процесс выполнения 
### Подготовка данных
Компания предоставила сырые данные в ходе производства предыдущих сплавов в виде нескольких таблиц. 

#### Описание данных

Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

#### Очистка 
По информации заказчика сырые данные могли содержать две аномалии: это сильно отрицательная мощность и температуры менее 1500 градусов.Оба этих случая были устранены. На основе анализа была подготовлена итоговая таблица признаков, которая использовалась для обучения моделей. 
Также были исключены данные с отсутствующей финальной температурой сплава

#### Создание новых признаков
Для улучшения показателей моделей машинного обучения были сгенерированы несколько дополнительных признаков на основе обработанных данных:
* Общее время изготовления сплава
* Активная мощность
    * Средняя мощность в процессе создания
    * Минимальная мощность
    * Максимальная мощность
* Работа (энергия) затраченная на изготовление
* Число циклов изготовления 


### Построение моделей 
#### Установки
Подготовленные данные были разделены на тренировочную и тестовую выборки в соотношении 4:1. Также для воспроизводимости результатов был зафиксирован генератор пседвослучайных чисел. 

Всего было исследовано три класса моделей машинного обучения:
* Линейные модели с регуляризацией 
    * Без масштабирования признаков
    * С масштабированием признаков
* Ансамблевая модель случайного леса
* Модели градиентного бустинга (LightGBM, CatBoost)

Качество моделей измерялось по метрике МАЕ: $L = \sum_i^N\frac{|y_i - y_i^0|}{N}$, где $L$ - финальное значение ошибки, N - число измерений, $y_0^i, y_i$ - истинные и предсказанные значения финальной температуры. Наилучшая модель отбиралась по лучшему значению на кросс-валидации. 

#### Результаты обучения 
Для удобства оценки и выборка наилучшей модели была заполнена таблица с показателями лучших алгоритмов из каждой категории.


<table border="1" width="100%">
 <tr>
    <td width="40%"> <table border="1" width="100%">
 <tr>
    <td>Название модели  </td> <td>Название на рисунке </td> <td>МАЕ</td>
 </tr>
 <tr>
    <td>Линейная модель с масштабированием</td> <td>lin_model_scale</td> <td>6.321992</td>
 </tr>
 <tr>
    <td>Линейная модель без масштабирования</td> <td>lin_model_no_scale</td> <td>6.189018</td>
 </tr>
 <tr>
    <td>Случайный лес</td> <td>rf_model</td> <td>6.329791</td>
 </tr>
 <tr>
    <td>LGBM </td> <td>lgbm_model</td> <td>3.672377</td>
 </tr>
 <tr>
    <td>CatBoost без надстроек</td> <td>ya_model_from_box</td> <td>2.933084</td>
 </tr>
 <tr>
    <td>CatBoost с подбором параметров</td> <td>ya_model_tune</td> <td>2.919772</td>
 </tr>
 </table></td>
     <td width="40%"> <img src=https://s1.hostingkartinok.com/uploads/images/2023/04/eec87309fe28e6c455a5945c010fdd03.png align="right"></td>
 </tr>
</table>

По представленным данным можно увидеть, что алгоритм градиентного бустинга CatBoost после небольшой надстройки дает наилучший показатель на тренировочной выборке. 
<img src=https://s1.hostingkartinok.com/uploads/images/2023/04/a2feeb11ff93459e1f49d4af6819a3bb.png width=40%>
При этом данный алгоритм выделяет начальную температуру, время нагрева и средняя активная мощность наиболее важными признаками. Последние два можно попробовать связать с тем, что чем дольше или сильнее нагреваешь сплав, тем выше конечная температура.

## Заключение
___
На основании проведенного анализа и моделирования мы можем предложить модель машинного обучения способную предсказать конечную температуру сплава с точностью до 5.9 градусов. Данная модель может использоваться для численного подбора параметров производства при минимизации расходов по электроэнергии.
